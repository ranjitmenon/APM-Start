{"ast":null,"code":"import { ProductService } from './product.service';\nimport { map, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./product.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../shared/star.component\";\nimport * as i5 from \"../shared/convert-to-spaces.pipe\";\n\nfunction ProductListComponent_table_14_tr_17_img_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 15);\n  }\n\n  if (rf & 2) {\n    const product_r4 = i0.ɵɵnextContext().$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵstyleProp(\"width\", ctx_r1.imageWidth, \"px\")(\"margin\", ctx_r1.imageMargin, \"px\");\n    i0.ɵɵproperty(\"src\", product_r4.imageUrl, i0.ɵɵsanitizeUrl)(\"title\", product_r4.productName);\n  }\n}\n\nfunction ProductListComponent_table_14_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtemplate(2, ProductListComponent_table_14_tr_17_img_2_Template, 1, 6, \"img\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"lowercase\");\n    i0.ɵɵpipe(8, \"convertToSpaces\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\")(15, \"pm-star\", 14);\n    i0.ɵɵlistener(\"ratingClicked\", function ProductListComponent_table_14_tr_17_Template_pm_star_ratingClicked_15_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.onRatingClicked($event));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const product_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.showImage);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r4.productName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 8, i0.ɵɵpipeBind1(7, 6, product_r4.productCode), \"-\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(product_r4.releaseDate);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind4(13, 11, product_r4.price, \"USD\", \"symbol\", \"1.2-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"rating\", product_r4.starRating);\n  }\n}\n\nfunction ProductListComponent_table_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"table\", 10)(1, \"thead\")(2, \"tr\")(3, \"th\")(4, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ProductListComponent_table_14_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleImage());\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Product\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Code\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Available\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"5 Star Rating\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"tbody\");\n    i0.ɵɵtemplate(17, ProductListComponent_table_14_tr_17_Template, 16, 16, \"tr\", 12);\n    i0.ɵɵpipe(18, \"search\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const Product_r5 = ctx.ngIf;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.showImage ? \"Hide\" : \"Show\", \" Image \");\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(18, 2, Product_r5, ctx_r1.searchText));\n  }\n}\n\nexport class ProductListComponent {\n  get listFilter() {\n    return this._listFiter;\n  }\n\n  set listFilter(value) {\n    this.filteredProducts$ = this.performFilter(value);\n    console.log('In setter:', value);\n  }\n\n  constructor(productService) {\n    this.productService = productService;\n    this.pageTitle = 'Product List';\n    this.imageWidth = 50;\n    this.imageMargin = 2;\n    this.showImage = false; //filteredProducts: IProduct[] = [];\n\n    this.errorMessage = '';\n    this._listFiter = '';\n  }\n\n  toggleImage() {\n    this.showImage = !this.showImage;\n  }\n\n  ngOnInit() {\n    //  this.sub =  this.productService.getProducts().subscribe({\n    //     next: products=> {\n    //       this.products = products;\n    //       this.filteredProducts = this.products;\n    //     },\n    //     error: err => this.errorMessage = err\n    //   });\n    this.products$ = this.productService.getProducts();\n    this.products$.pipe(map(x => x), tap(x => console.log(`The value of product$ is ${x}`)));\n    this.filteredProducts$ = this.products$; // this.filteredProducts$ .pipe(\n    //   map(x=> x),\n    //   tap(x=> console.log(`The value of filteredProducts$ is ${x}`)))\n  }\n\n  onRatingClicked(mesage) {\n    this.pageTitle = 'Product List: ' + mesage;\n  }\n\n  performFilter(filterBy) {\n    filterBy = filterBy.toLocaleLowerCase();\n    return this.products$?.pipe(map(products => products.filter(product => product.productName.toLocaleLowerCase().includes(filterBy))));\n  }\n\n  static #_ = this.ɵfac = function ProductListComponent_Factory(t) {\n    return new (t || ProductListComponent)(i0.ɵɵdirectiveInject(i1.ProductService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductListComponent,\n    selectors: [[\"ng-component\"]],\n    features: [i0.ɵɵProvidersFeature([ProductService])],\n    decls: 16,\n    vars: 6,\n    consts: [[1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [1, \"row\"], [1, \"col-md-2\"], [1, \"col-md-4\"], [\"type\", \"text\", 3, \"ngModelChange\", \"ngModel\"], [1, \"col-md-6\"], [1, \"table-responsive\"], [\"class\", \"table\", 4, \"ngIf\"], [1, \"table\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [3, \"src\", \"title\", \"width\", \"margin\", 4, \"ngIf\"], [3, \"ratingClicked\", \"rating\"], [3, \"src\", \"title\"]],\n    template: function ProductListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"div\", 3)(5, \"div\", 4);\n        i0.ɵɵtext(6, \" Filter by:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 5)(8, \"input\", 6);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function ProductListComponent_Template_input_ngModelChange_8_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.listFilter, $event) || (ctx.listFilter = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(9, \"div\", 3)(10, \"div\", 7)(11, \"h4\");\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(13, \"div\", 8);\n        i0.ɵɵtemplate(14, ProductListComponent_table_14_Template, 19, 5, \"table\", 9);\n        i0.ɵɵpipe(15, \"async\");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" \", ctx.pageTitle, \" \");\n        i0.ɵɵadvance(6);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.listFilter);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"Filtered by: \", ctx.listFilter, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(15, 4, ctx.products$));\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i4.StarComponent, i2.AsyncPipe, i2.LowerCasePipe, i2.CurrencyPipe, i5.ConvertToSpacesPipe],\n    styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"AAEA,SAASA,cAAT,QAA+B,mBAA/B;AACA,SAAmCC,GAAnC,EAAwCC,GAAxC,QAAmD,MAAnD;;;;;;;;;;ICmCYC;;;;;;IAIKA,EADA,YACA,CADA,OACA,EADAC,iBACA,EADA,IACA,EAD6B,QAC7B,EAD6BA,kBAC7B,EAD6B,IAC7B;IAFAD,EADA,WACA,CADA,KACA,EADAE,mBACA,EADAF,gBACA,EADwB,OACxB,EADwBE,sBACxB;;;;;;;;IAHPF,EADF,eACE,CADF,CACE,EADF,IACE,EADwD,CACxD,EADwD,IACxD;IACEA;IAMFA;IACAA;IAAIA;IAAuBA;IAC3BA;IAAIA;;;IAAyDA;IAC7DA;IAAIA;IAAuBA;IAC3BA;IAAIA;;IAAmDA;IACnDA,EAAJ,eAAI,CAAJ,EAAI,EAAJ,IAAI;IACUA;MAAAA;MAAA;MAAA,sBAAiBC,8BAAjB;IAAwC,CAAxC;IAChBD,EAD0D,aAC1D;;;;;;IAbUA;IAAAA;IAOJA;IAAAA;IACAA;IAAAA;IACAA;IAAAA;IACAA;IAAAA;IACSA;IAAAA;;;;;;;;IA1BbA,EAJN,eAIM,CAJN,CAIM,EAJN,OAIM,EAJN,EAIM,EAJoD,CAIpD,EAJoD,OAIpD,EAHC,CAGD,EAHC,IAGD,EAFA,CAEA,EAFA,IAEA,EADE,CACF,EADE,QACF,EADE,EACF;IACCA;MAAAA;MAAA;MAAA,sBAASC,oBAAT;IAAsB,CAAtB;IACCD;IAEJA,EADE,aACF;IACAA;IAAIA;IAAOA;IACXA;IAAIA;IAAIA;IACRA;IAAIA;IAASA;IACbA;IAAIA;IAAKA;IACTA;IAAIA;IAERA,EAFqB,aAErB;IACAA;IACIA;;IAiBJA,EADA,aACA;;;;;;IA5BQA;IAAAA;IAWoBA;IAAAA;;;;AD1BhC,OAAM,MAAOG,oBAAP,CAA2B;EAUjB,IAAVC,UAAU;IACZ,OAAO,KAAKC,UAAZ;EACD;;EAEa,IAAVD,UAAU,CAACE,KAAD,EAAc;IAC1B,KAAKC,iBAAL,GAAyB,KAAKC,aAAL,CAAmBF,KAAnB,CAAzB;IACAG,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BJ,KAA1B;EACD;;EAEDK,YAAoBC,cAApB,EAAkD;IAA9B;IAlBpB,iBAAoB,cAApB;IACA,kBAAqB,EAArB;IACA,mBAAsB,CAAtB;IACA,iBAAqB,KAArB,CAekD,CAdlD;;IACA,oBAAuB,EAAvB;IACQ,kBAAqB,EAArB;EAcP;;EAMDC,WAAW;IACT,KAAKC,SAAL,GAAiB,CAAC,KAAKA,SAAvB;EACD;;EAEDC,QAAQ;IACR;IACA;IACA;IACA;IACA;IACA;IACA;IAEA,KAAKC,SAAL,GAAiB,KAAKJ,cAAL,CAAoBK,WAApB,EAAjB;IACA,KAAKD,SAAL,CAAgBE,IAAhB,CACEpB,GAAG,CAACqB,CAAC,IAAGA,CAAL,CADL,EAEEpB,GAAG,CAACoB,CAAC,IAAGV,OAAO,CAACC,GAAR,CAAY,4BAA4BS,CAAC,EAAzC,CAAL,CAFL;IAIA,KAAKZ,iBAAL,GAAyB,KAAKS,SAA9B,CAdQ,CAgBR;IACA;IACA;EACC;;EAEDI,eAAe,CAACC,MAAD,EAAe;IAC5B,KAAKC,SAAL,GAAiB,mBAAmBD,MAApC;EACD;;EAEDb,aAAa,CAACe,QAAD,EAAiB;IAC5BA,QAAQ,GAAGA,QAAQ,CAACC,iBAAT,EAAX;IACA,OAAO,KAAKR,SAAL,EAAgBE,IAAhB,CAAqBpB,GAAG,CAAC2B,QAAQ,IAAIA,QAAQ,CAACC,MAAT,CAAiBC,OAAD,IAC1DA,OAAO,CAACC,WAAR,CAAoBJ,iBAApB,GAAwCK,QAAxC,CAAiDN,QAAjD,CAD0C,CAAb,CAAxB,CAAP;EAED;;EA5D8B;qBAApBpB,sBAAoBH;EAAA;EAAA;UAApBG;IAAoB2B;IAAAC,iCAFpB,CAAClC,cAAD,CAEoB;IAFJmC;IAAAC;IAAAC;IAAAC;MAAA;QCP5BnC,EADD,eACC,CADD,CACC,EADD,KACC,EADD,CACC,EADiB,CACjB,EADiB,KACjB,EADiB,CACjB;QACGA;QACHA;QAGKA,EAFL,eAEK,CAFL,CAEK,EAFL,KAEK,EAFL,CAEK,EAFkB,CAElB,EAFkB,KAElB,EAFkB,CAElB,EADa,CACb,EADa,KACb,EADa,CACb;QAAuBA;QAAUA;QAE/BA,EADF,eACE,CADF,CACE,EADF,KACE,EADF,CACE,EADoB,CACpB,EADoB,OACpB,EADoB,CACpB;QAAoBA;UAAAA;UAAA;QAAA;QAE1BA,EAFM,aAEN;QAGIA,EAFJ,eAEI,CAFJ,CAEI,EAFJ,KAEI,EAFJ,CAEI,EAFa,EAEb,EAFa,KAEb,EAFa,CAEb,EADoB,EACpB,EADoB,IACpB;QAAIA;QAERA,EAFmC,aAEnC;QAGAA;QACEA;;QAqCJA,EAFE,aAEF;;;;QAtDIA;QAAAA;QAMwBA;QAAAA;QAKlBA;QAAAA;QAMgBA;QAAAA;;;;;IDTO;AAAA","names":["ProductService","map","tap","i0","ctx_r1","product_r4","ProductListComponent","listFilter","_listFiter","value","filteredProducts$","performFilter","console","log","constructor","productService","toggleImage","showImage","ngOnInit","products$","getProducts","pipe","x","onRatingClicked","mesage","pageTitle","filterBy","toLocaleLowerCase","products","filter","product","productName","includes","selectors","features","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/ranjitmenon/APM-Start/APM-Start/src/app/product/product-list.component.ts","/home/ranjitmenon/APM-Start/APM-Start/src/app/product/product-list.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { IProduct } from './product';\r\nimport { ProductService } from './product.service';\r\nimport { Observable, Subscription, map, tap } from 'rxjs';\r\n\r\n@Component({\r\n  templateUrl: './product-list.component.html',\r\n  styleUrl: './product-list.component.css',\r\n  providers: [ProductService]\r\n})\r\nexport class ProductListComponent implements OnInit {\r\n  pageTitle: string = 'Product List';\r\n  imageWidth: number = 50;\r\n  imageMargin: number = 2;\r\n  showImage: boolean = false;\r\n  //filteredProducts: IProduct[] = [];\r\n  errorMessage: string = '';\r\n  private _listFiter: string = '';\r\n  sub!: Subscription;\r\n\r\n  get listFilter(): string {\r\n    return this._listFiter;\r\n  }\r\n\r\n  set listFilter(value: string) {\r\n    this.filteredProducts$ = this.performFilter(value);\r\n    console.log('In setter:', value);\r\n  }\r\n\r\n  constructor(private productService: ProductService) {\r\n\r\n  }\r\n\r\n  //products: IProduct[] = [];\r\n products$!: Observable<IProduct[]>\r\n filteredProducts$!: Observable<IProduct[]> ;\r\n\r\n  toggleImage(): void {\r\n    this.showImage = !this.showImage;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  //  this.sub =  this.productService.getProducts().subscribe({\r\n  //     next: products=> {\r\n  //       this.products = products;\r\n  //       this.filteredProducts = this.products;\r\n  //     },\r\n  //     error: err => this.errorMessage = err\r\n  //   });\r\n\r\n  this.products$ = this.productService.getProducts();\r\n  this.products$ .pipe(\r\n    map(x=> x),\r\n    tap(x=> console.log(`The value of product$ is ${x}`))\r\n  )\r\n  this.filteredProducts$ = this.products$;\r\n\r\n  // this.filteredProducts$ .pipe(\r\n  //   map(x=> x),\r\n  //   tap(x=> console.log(`The value of filteredProducts$ is ${x}`)))\r\n  }\r\n\r\n  onRatingClicked(mesage: string): void {\r\n    this.pageTitle = 'Product List: ' + mesage;\r\n  }\r\n\r\n  performFilter(filterBy: string): Observable<IProduct[]>   {\r\n    filterBy = filterBy.toLocaleLowerCase();\r\n    return this.products$?.pipe(map(products => products.filter((product: IProduct) =>\r\n      product.productName.toLocaleLowerCase().includes(filterBy))));\r\n  }\r\n\r\n  // ngOnDestroy() {\r\n  //   this.sub.unsubscribe();\r\n  // }\r\n}\r\n","<div class='card'>\r\n <div class='card-header'>\r\n    {{pageTitle}}\r\n </div>\r\n <div class='card-body'>\r\n  <div class='row'>\r\n      <div class='col-md-2'> Filter by:</div>\r\n      <div class='col-md-4'>\r\n        <input type= 'text' [(ngModel)]='listFilter'/>\r\n      </div>\r\n  </div>\r\n  <div class='row'>\r\n    <div class='col-md-6'>\r\n      <h4>Filtered by: {{listFilter}}</h4>\r\n    </div>\r\n  </div>\r\n\r\n\r\n  <div class='table-responsive'>\r\n    <table class='table' *ngIf='products$ | async as Product'>\r\n    <thead>\r\n      <tr>\r\n        <th>\r\n          <button class='btn btn-primary'\r\n           (click)='toggleImage()'>\r\n            {{showImage ? 'Hide' : 'Show'}} Image\r\n          </button>\r\n        </th>\r\n        <th>Product</th>\r\n        <th>Code</th>\r\n        <th>Available</th>\r\n        <th>Price</th>\r\n        <th>5 Star Rating</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n        <tr *ngFor=\"let product of Product | search: searchText \">\r\n          <td>\r\n            <img *ngIf='showImage'\r\n                 [src]='product.imageUrl'\r\n                 [title]='product.productName'\r\n                 [style.width.px]='imageWidth'\r\n                 [style.margin.px]='imageMargin'\r\n                >\r\n          </td>\r\n          <td>{{product.productName}}</td>\r\n          <td>{{product.productCode | lowercase | convertToSpaces:'-'}}</td>\r\n          <td>{{product.releaseDate}}</td>\r\n          <td>{{product.price | currency:'USD':'symbol':'1.2-2'}}</td>\r\n          <td><pm-star [rating]='product.starRating'\r\n                        (ratingClicked)='onRatingClicked($event)'></pm-star></td>\r\n        </tr>\r\n    </tbody>\r\n    </table>\r\n  </div>\r\n</div>\r\n</div>\r\n\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}